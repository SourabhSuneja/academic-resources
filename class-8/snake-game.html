<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Snake Game</title>
      <style>
         body {
         display: flex;
         justify-content: center;
         align-items: center;
         height: 100vh;
         margin: 0;
         background: linear-gradient(135deg, #ff7e5f, #feb47b);
         font-family: 'Arial', sans-serif;
         overflow: hidden;
         }
         .game-container {
         position: relative;
         display: flex;
         flex-direction: column;
         align-items: center;
         background: rgba(0, 0, 0, 0.5);
         border-radius: 15px;
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
         }
         canvas {
         border: 5px solid #fff;
         background-color: #2c3e50;
         }
         .score-board {
         position: fixed;
         top: 10px;
         left: 10px;
         background: rgba(0, 0, 0, 0.7);
         color: #fff;
         padding: 10px;
         border-radius: 5px;
         font-size: 1.5em;
         font-weight: bold;
         }
         .controls {
         display: flex;
         flex-direction: column;
         align-items: center;
         padding: 10px;
         }
         .control-button {
         background: #3498db;
         border: none;
         border-radius: 50%;
         color: #fff;
         font-size: 1.5em;
         width: 60px;
         height: 60px;
         cursor: pointer;
         margin: 5px;
         display: flex;
         align-items: center;
         justify-content: center;
         }
         .control-button:active {
         background: #2980b9;
         }
         .arrow-buttons {
         display: flex;
         flex-direction: column;
         align-items: center;
         }
         .arrow-buttons div {
         display: flex;
         }
         .arrow-buttons .row {
         display: flex;
         }
         .arrow-buttons .row button {
         margin: 0 5px;
         }
         .speed-control, .game-control {
         background: #3498db;
         border: none;
         border-radius: 5px;
         color: #fff;
         font-size: 1em;
         padding: 5px 10px;
         cursor: pointer;
         margin: 5px;
         }
         .popup {
         position: fixed;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         background: rgba(0, 0, 0, 0.8);
         display: flex;
         justify-content: center;
         align-items: center;
         visibility: hidden;
         opacity: 0;
         transition: visibility 0.3s, opacity 0.3s;
         z-index: 1000;
         }
         .popup.active {
         visibility: visible;
         opacity: 1;
         }
         .popup-content {
         background: #fff;
         color: #333;
         padding: 20px;
         border-radius: 10px;
         text-align: center;
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
         }
         .popup-content h2 {
         margin: 0;
         }
         .popup-content button {
         background: #e74c3c;
         border: none;
         color: #fff;
         padding: 10px 20px;
         border-radius: 5px;
         cursor: pointer;
         font-size: 1em;
         }
         @media (max-width: 600px) {
         canvas {
         width: 300px;
         height: 300px;
         }
         }
      </style>
   </head>
   <body>
      <div class="game-container">
         <canvas id="gameCanvas"></canvas>
         <div class="score-board">
            <span>Score: <span id="score">0</span></span>
         </div>
         <div class="controls">
            <div class="arrow-buttons">
               <button class="control-button" id="up">↑</button>
               <div class="row">
                  <button class="control-button" id="left">←</button>
                  <button class="control-button" id="down">↓</button>
                  <button class="control-button" id="right">→</button>
               </div>
            </div>
         </div>
         <button class="speed-control" id="speedControl">Speed: Slow</button>
         <div class="game-controls">
            <button class="game-control" id="startGame">Start Game</button>
            <button class="game-control" id="pauseGame">Pause Game</button>
         </div>
      </div>
      <div class="popup" id="gameOverPopup">
         <div class="popup-content">
            <h2>Game Over!</h2>
            <button id="restartButton">Play Again</button>
         </div>
      </div>
      <script>
         const canvas = document.getElementById('gameCanvas');
         const ctx = canvas.getContext('2d');
         
         const scale = 20;
         const rows = canvas.height / scale;
         const columns = canvas.width / scale;
         
         let snake;
         let food;
         let score = 0;
         let direction = 'right';
         let newDirection = 'right';
         let fps = 5; // Desired frame rate
         let frameDuration = 1000 / fps; // Duration of one frame in milliseconds
         let lastFrameTime = 0;
         let gamePaused = false;
         
         // Handle keyboard input
         document.addEventListener('keydown', (event) => {
         switch(event.key) {
         case 'ArrowUp':
             if (direction !== 'down') newDirection = 'up';
             break;
         case 'ArrowDown':
             if (direction !== 'up') newDirection = 'down';
             break;
         case 'ArrowLeft':
             if (direction !== 'right') newDirection = 'left';
             break;
         case 'ArrowRight':
             if (direction !== 'left') newDirection = 'right';
             break;
         }
         });
         
         // Handle touch input
         document.getElementById('left').addEventListener('click', () => {
         if (direction !== 'right') newDirection = 'left';
         });
         document.getElementById('right').addEventListener('click', () => {
         if (direction !== 'left') newDirection = 'right';
         });
         document.getElementById('up').addEventListener('click', () => {
         if (direction !== 'down') newDirection = 'up';
         });
         document.getElementById('down').addEventListener('click', () => {
         if (direction !== 'up') newDirection = 'down';
         });
         
         document.getElementById('speedControl').addEventListener('click', () => {
         if (fps === 5) {
         fps = 7; // Medium speed
         document.getElementById('speedControl').textContent = 'Speed: Medium';
         } else if (fps === 7) {
         fps = 10; // High speed
         document.getElementById('speedControl').textContent = 'Speed: High';
         } else {
         fps = 5; // Slow speed
         document.getElementById('speedControl').textContent = 'Speed: Slow';
         }
         frameDuration = 1000 / fps; // Update frame duration
         });
         
         document.getElementById('startGame').addEventListener('click', () => {
         if (!gamePaused) {
         setup();
         } else {
         gamePaused = false;
         requestAnimationFrame(gameLoop);
         }
         });
         
         document.getElementById('pauseGame').addEventListener('click', () => {
         gamePaused = true;
         });
         
         function setup() {
         canvas.width = 400;
         canvas.height = 400;
         snake = new Snake();
         food = getRandomFoodPosition();
         score = 0; // Reset score on restart
         document.getElementById('score').textContent = score;
         hideGameOverPopup();
         gamePaused = false;
         lastFrameTime = 0; // Initialize frame time
         requestAnimationFrame(gameLoop); // Start the game loop
         }
         
         function getRandomFoodPosition() {
         return {
         x: Math.floor(Math.random() * columns) * scale,
         y: Math.floor(Math.random() * rows) * scale
         };
         }
         
         function gameLoop(timestamp) {
         const elapsedTime = timestamp - lastFrameTime;
         
         if (elapsedTime >= frameDuration) {
         lastFrameTime = timestamp - (elapsedTime % frameDuration);
         
         if (!gamePaused) {
             ctx.clearRect(0, 0, canvas.width, canvas.height);
         
             snake.update();
             snake.draw();
         
             ctx.fillStyle = '#e74c3c'; // Red color for food
             ctx.beginPath();
             ctx.arc(food.x + scale / 2, food.y + scale / 2, scale / 2, 0, Math.PI * 2);
             ctx.fill();
         
             if (snake.eat(food)) {
                 score++;
                 document.getElementById('score').textContent = score;
                 food = getRandomFoodPosition();
             }
         
             if (snake.collide()) {
                 showGameOverPopup();
                 return;
             }
         }
         }
         
         requestAnimationFrame(gameLoop);
         }
         
         class Snake {
         constructor() {
         this.body = [{x: Math.floor(columns / 2) * scale, y: Math.floor(rows / 2) * scale}];
         this.length = 1;
         this.xSpeed = scale;
         this.ySpeed = 0;
         }
         
         update() {
         direction = newDirection;
         const head = {x: this.body[0].x + this.xSpeed, y: this.body[0].y + this.ySpeed};
         this.body.unshift(head);
         if (!this.eat(food)) {
             this.body.pop();
         }
         this.xSpeed = direction === 'left' ? -scale : direction === 'right' ? scale : 0;
         this.ySpeed = direction === 'up' ? -scale : direction === 'down' ? scale : 0;
         }
         
         draw() {
         ctx.fillStyle = '#2ecc71'; // Green color for snake
         this.body.forEach(part => {
             ctx.beginPath();
             ctx.arc(part.x + scale / 2, part.y + scale / 2, scale / 2, 0, Math.PI * 2);
             ctx.fill();
         });
         }
         
         eat(food) {
         if (this.body[0].x === food.x && this.body[0].y === food.y) {
             this.length++;
             return true;
         }
         return false;
         }
         
         collide() {
         const [head, ...body] = this.body;
         
         // Check if snake hits the wall
         if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height) {
             return true;
         }
         
         // Check if snake collides with itself
         for (let i = 1; i < this.body.length; i++) {
             if (head.x === this.body[i].x && head.y === this.body[i].y) {
                 return true;
             }
         }
         return false;
         }
         }
         
         function showGameOverPopup() {
         document.getElementById('gameOverPopup').classList.add('active');
         }
         
         function hideGameOverPopup() {
         document.getElementById('gameOverPopup').classList.remove('active');
         }
         
         document.getElementById('restartButton').addEventListener('click', () => {
         hideGameOverPopup();
         setup();
         });
         
         // Initialize game state but do not start the loop until "Start Game" is clicked
         setup();
      </script>
   </body>
</html>